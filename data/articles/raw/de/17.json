{"title": "RegreSSHion: Sicherheitsl\u00fccke in OpenSSH gibt geduldigen Angreifern Root-Rechte", "timestamp": "2024-07-01T12:59:00Z", "content": "\n\n\n        Wer die alte, neue L\u00fccke im SSH-Server ausnutzen m\u00f6chte, braucht Sitzfleisch: Bis zur Root-Shell dauert es 8 Stunden. Daf\u00fcr klappt der Angriff aus der Ferne.\n      \n\n      \n        regreSSHion\n      \n    \n\n      (Bild:\u00a0Qualys)\n    \nSicherheitsforscher haben eine fast zwanzig Jahre alte L\u00fccke im OpenSSH-Server wiederbelebt und konnten sich mit ihrer Hilfe Root-Rechte verschaffen. W\u00e4hrend ihrer Nachforschungen konnten sie einen funktionierenden Exploit f\u00fcr aktuelle SSH-Versionen entwickeln, es gelten jedoch einige Vorbedingungen. Angreifer sollten zudem nicht in Eile sein: Eine erfolgreiche Attacke dauert mehrere Stunden.\nAls \"Regression\" (w\u00f6rtlich \"R\u00fcckschritt\") bezeichnen Softwareentwickler unter anderem einen Fehler, der bereits behoben war, durch andere \u00c4nderungen am Quellcode aber wieder auftaucht. Einen solchen Regressionsfehler haben Mitarbeiter der Securityfirma Qualys im OpenSSH-Projekt gefunden und ihn folgerichtig \"RegreSSHion\" getauft. Bereits im Jahr 2006 tauchte der Programmierschnitzer als CVE-2006-5051 auf \u2013 ihn zur Ausf\u00fchrung eigener Befehle auszunutzen, war damals jedoch niemandem gegl\u00fcckt. Zwar hatte das OpenSSH-Team den Fehler damals behoben, im Oktober 2020 jedoch irrt\u00fcmlich wieder eingebaut.\nBei der nun mit der CVE-ID CVE-2024-6387 und gem\u00e4\u00df Qualys mit einem CVSS-Wert von 8,1/10, somit also hohem Schweregrad, versehenen Neuauflage handelt es sich um denselben grundlegenden Fehler. Ursache ist eine Wettlaufsituation (Race Condition) rund um den Abbruch nicht erfolgreicher SSH-Verbindungen. Sendet ein Client innerhalb von 120 Sekunden (die Dauer ist konfigurierbar) keine Authentifizierungsdaten, so wird durch den SSH-Server das Unix-Signal SIGALRM gesendet, um etwa die Protokollierung dieses Ereignisses mittels syslog()-Aufrufen auszul\u00f6sen. Diese sind jedoch nicht f\u00fcr asynchrone Funktionsaufrufe ausgelegt, was Angreifer mit einem hervorragenden Sinn f\u00fcr Timing in die Lage versetzt, eigenen Code einzuschleusen.\nDie Forscher von Qualys haben diesen Fehler in drei verschiedenen Umgebungen erfolgreich ausnutzen k\u00f6nnen: In zwei Uralt-Versionen des SSH-Servers von 2006 und in OpenSSH 9.2p1 unter Debian GNU/Linux. Letztere Version ist aus dem Jahr 2024, mithin recht aktuell. Derzeit scheint es so, als seien nur glibc-basierte Systeme erfolgreich angreifbar, insbesondere OpenBSD ist Qualys zufolge immun.\nSie mussten dazu nicht nur verschiedene Sicherheitsmechanismen des Betriebssystems und der glibc austricksen, sondern auch viel Geduld mitbringen: Der Exploit funktioniert nur in etwa jedem zehntausendsten Versuch, nach Ablauf des standardm\u00e4\u00dfig 120 Sekunden langen Timeouts (LoginGraceTime) und derzeit auch nur auf 32-Bit-Systemen. L\u00e4sst der SSH-Server einhundert parallele Verbindungen zu, haben Angreifer nach sechs bis acht Stunden Erfolg.\nZwar waren die Qualys-Forscher zun\u00e4chst nur auf i386-Systemen erfolgreich, ein Exploit f\u00fcr 64-bittige Linuxe ist ihnen zufolge noch in Arbeit. Sobald er fertig ist, d\u00fcrfte er jedoch noch langsamer sein als sein 32-Bit-Gegenst\u00fcck \u2013 mehr als acht Stunden, aber weniger als eine Woche k\u00f6nnte es dauern, bis Angreifer Root-Rechte erlangen.\nDie Qualys-Experten haben sowohl eine umfangreiche theoretische Herleitung der L\u00fccke als auch ihre praktischen Versuche, sie auszunutzen, ver\u00f6ffentlicht. Der Sicherheitshinweis gibt einen Einblick in die Komplexit\u00e4t moderner Exploit-Entwicklung und liest sich zudem wie ein IT-Krimi.\nDen Forschern von Qualys zufolge sind folgende OpenSSH-Versionen verwundbar:\nAdmins sollten pr\u00fcfen, ob ihre Linux-Systeme \u00fcber aktuelle SSH-Versionen verf\u00fcgen. Sowohl Debian als auch Ubuntu haben neue Pakete auf Lager, Red Hat forscht noch. Ersten Analysen zufolge ist jedoch nur Red Hat Enterprise Linux 9 betroffen, da alle anderen Versionen des Red-Hat-Linux \u00e4ltere OpenSSH-Versionen mitbringen.\nDer minimale CVSS-Punktwert betr\u00e4gt 9,0 und nicht 9,9, CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H. Nimmt man eine niedrige Angriffskomplexit\u00e4t an, kommt man gar auf 10. Wir haben den Text entsprechend korrigiert. Zudem haben wir das Logo der Sicherheitsl\u00fccke als Aufmacher verwendet, das Qualys uns zur Verf\u00fcgung gestellt hat.\nAktuellen Informationen von Qualys zufolge betr\u00e4gt der offizielle CVSS-Wert 8,1/10 und die Standardeinstellungen bei Debian erlauben trotz zuf\u00e4lliger konfigurierbarer Abbr\u00fcche 100 parallele Verbindungen. Wir haben den Text entsprechend aktualisiert. Lesen Sie auch unseren Hintergrundbericht \u00fcber die aktuellen Entwicklungen.\n\n\n(cku)\n\n\n\n    Ob Sicherheitsl\u00fccken, Viren oder Trojaner \u2013 alle sicherheitsrelevanten Meldungen gibts bei heise Security\n  \n\n    Ausf\u00fchrliche Informationen zum Versandverfahren und zu Ihren\n    Widerrufsm\u00f6glichkeiten erhalten Sie in unserer\n    Datenschutzerkl\u00e4rung.\n  \n\nImmer informiert bleiben: Klicken Sie auf das Plus-Symbol an einem Thema, um diesem zu folgen. Wir zeigen Ihnen alle neuen Inhalte zu Ihren Themen.\n\n          Mehr erfahren.\n        \n\n\nExklusive Tests, Ratgeber & Hintergr\u00fcnde. Unbegrenzter Zugriff auf alle heise+ Beitr\u00e4ge inkl. allen Digital-Magazinen.", "language": "de"}